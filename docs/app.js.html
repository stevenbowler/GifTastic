<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: app.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: app.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// @ts-check

/** 
 * @top
 * @function top
 * @todo how to {@link pauseAudio} onclick of youtube iframe embed, i.e. play one or the other.
 * 
 * */


/**
 * Wraps all JQuery
 * @event documentReady
*/
$(document).ready(function () {


    /** 
     * Generic function for capturing the feeling name from the data-attribute, called from {@link bottom}
     * @function renderButtons 
     */
    const renderButtons = () => {
        // Deleting the feelings prior to adding new feelings
        // (this is necessary otherwise we will have repeat buttons)
        $("#buttons-view").empty();

        // Looping through the array of feelings
        for (var i = 0; i &lt; feelings.length; i++) {
            var a = $("&lt;button>");
            a.addClass("feeling btn btn-outline-light");
            a.attr("data-name", feelings[i]);
            a.text(feelings[i]);
            $("#buttons-view").append(a);
        }
    }



    /**
     * Double click any gif displayed to add to the {@link favoriteArray} and in local storage "favoriteArray"
     * @event documentOnDoubleClickGif
     */
    const documentOnDoubleClickGif = $(document.body).on("dblclick", ".gif", function (e) {
        var gifNode = {
            still: e.target.attributes.getNamedItem("data-still").textContent,
            animate: e.target.attributes.getNamedItem("data-animate").textContent
        }
        favoriteArray.push(gifNode);
        console.log("gifNode: ", gifNode, " favoriteArray: ", favoriteArray);
        localStorage.setItem("favoriteArray", JSON.stringify(favoriteArray));
        alert("just added to favorites, now " + favoriteArray.length + " favorites.");
    });



    /** 
     * Onclick event when user requests to add a new feeling to {@link feelingArray}, then call {@link renderButtons}
     * @constant
     * @event onClickAddFeeling
    */
    const onClickAddFeeling = $("#add-feeling").on("click", function (event) {
        event.preventDefault();
        //@ts-ignore
        var feeling = $("#feeling-input").val().trim();
        feelings.push(feeling);
        renderButtons();
    });



    /** called from {@link $(document).on("click")} event listener click on feeling class
     * @function alertFeelingName 
     * @param {object} e event object
     */
    const alertFeelingName = (e) => {
        if (gifCount >= 100) { alert("max 100 gifs exceeded, choose another feeling"); return; }
        var feeling = e.target.innerText;
        if (feeling === "Add 10 Gifs") {
            console.log("feeling" + feeling);
            feeling = lastFeeling;
            gifCount = gifCount + 10;
        }
        else {
            gifCount = 0;
            lastFeeling = feeling;
        }
        feelingView.empty();
        $("#base").empty();
        var url = "https://api.giphy.com/v1/gifs/search?api_key=sGt5xc6wCkBEmaU8njjufs8ZOuKh5enL&amp;limit=100&amp;q=" + feeling;
        console.log("Feeling name is: " + e.target.innerText + "feeling: " + feeling);
        $.ajax({ url, method: "GET" })
            .then(function (response) {
                if (gifCount === 0) {       // if new feeling empty everything then reload
                }
                console.log(response);
                var x = gifCount + 10;
                console.log("x: " + x + " gifCount " + gifCount);
                for (var i = 0; i &lt; x; i++) {
                    var gifDiv = $("&lt;div style='float:left;' class='animated zoomInRight'>");
                    var gif = $("&lt;img>");
                    var pTitle = $("&lt;p class='text-light' style='line-height:1;'>");
                    var pRating = $("&lt;p class='text-light' style='line-height:0;'>");
                    var oldGif = $("#image" + i.toString());
                    oldGif.removeAttr("data-still");
                    oldGif.removeAttr("data-animate");
                    gif.addClass("gif");
                    console.log("i: ", i);
                    gif.attr("src", response.data[i].images.original_still.url);
                    gif.attr("rating", response.data[i].rating);
                    pTitle.text("Title: " + response.data[i].title);
                    pRating.text("Rating: " + response.data[i].rating);
                    gif.attr("data-name", "image" + i.toString());
                    gif.attr("id", "image" + i.toString());
                    gif.attr("data-still", response.data[i].images.original_still.url);
                    // console.log("response data-still" + response.data[i].images.original_still.url);
                    gif.attr("data-animate", response.data[i].images.original.url);
                    // console.log("response data-" + response.data[i].images.original.url);
                    gif.attr("data-state", "still");
                    gifDiv.append(gif);
                    gifDiv.append(pTitle);
                    gifDiv.append(pRating);
                    feelingView.append(gifDiv);
                    // gif.appendTo("#feeling-view");
                    // p.appendTo("#feeling-view");
                    feelingView.appendTo("#base");
                    // gifCount = gifCount + 10;
                }


                /**
                 * On click class gif calls {@link gifStillAnimate} set onclick after div built
                 * @event feelingViewOnClick
                 */
                const feelingViewOnClick = feelingView.on("click", ".gif", gifStillAnimate);
            }).catch(function (err) {
                console.log(err);
            }
            );
    }



    /**
     * Onclick toggle between animate and still called after the feeling-view class is created
     * @function gifStillAnimate 
     * @param {object} e
     */
    const gifStillAnimate = (e) => {

        // data-name = id so set selector to #data-name to access data in event object
        var thisId = "#" + e.target.attributes.getNamedItem("data-name").textContent;
        var state = $(thisId).attr("data-state"); // could be "animate"
        // console.log("data-name: " + $(thisId).attr("data-name"));
        // console.log("127 event on click gif: state: " + state);
        if (state === "still") {
            var image = e.target.attributes.getNamedItem("data-animate").textContent;
            $(thisId).attr("src", image);
            $(thisId).attr("data-state", "animate");
        }
        else {
            var image = e.target.attributes.getNamedItem("data-still").textContent;
            $(thisId).attr("src", image);
            $(thisId).attr("data-state", "still");
        }
    }


    /**
     * Called from various points to animate unload load of content in divs,
     *      from GitHub animate.css library
     * @async
     * @function animateCSS
     * @param {*} element div id/class/tag to be modified
     * @param {*} animationName from list of animateCSS classes
     * @param {*} [callback] required if unloading before loading div with content, async
     */
    const animateCSS = (element, animationName, callback) => {
        const node = document.querySelector(element)
        node.classList.add('animated', animationName)

        function handleAnimationEnd() {
            node.classList.remove('animated', animationName)
            node.removeEventListener('animationend', handleAnimationEnd)

            if (typeof callback === 'function') callback()
        }

        node.addEventListener('animationend', handleAnimationEnd)
    }


    /**
     * Onclick event when user requests to add 10 gifs to {@link feelingView} then call {@link alertFeelingName} 
     * @event addTenOnClick
     */
    const addTenOnClick = $(document).on("click", "#add-ten-gifs", alertFeelingName);


    /**
     * On click feeling class to call {@link alertFeelingName}
     * @event documentOnClickFeeling 
     */
    const documentOnClickFeeling = $(document).on("click", ".feeling", alertFeelingName);


    /**@bottom Calling the renderButtons function to display the intial buttons
     */
    renderButtons();

});</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">GifTastic</a></h2><h3>Events</h3><ul><li><a href="global.html#event:addTenOnClick">addTenOnClick</a></li><li><a href="global.html#event:documentOnClickFeeling">documentOnClickFeeling</a></li><li><a href="global.html#event:documentOnDoubleClickGif">documentOnDoubleClickGif</a></li><li><a href="global.html#event:documentReady">documentReady</a></li><li><a href="global.html#event:feelingViewOnClick">feelingViewOnClick</a></li><li><a href="global.html#event:onClickAddFeeling">onClickAddFeeling</a></li></ul><h3>Global</h3><ul><li><a href="global.html#alertFeelingName">alertFeelingName</a></li><li><a href="global.html#animateCSS">animateCSS</a></li><li><a href="global.html#favoriteArray">favoriteArray</a></li><li><a href="global.html#feelings">feelings</a></li><li><a href="global.html#feelingView">feelingView</a></li><li><a href="global.html#gifCount">gifCount</a></li><li><a href="global.html#gifStillAnimate">gifStillAnimate</a></li><li><a href="global.html#lastFeeling">lastFeeling</a></li><li><a href="global.html#renderButtons">renderButtons</a></li><li><a href="global.html#top">top</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Thu Mar 05 2020 14:23:21 GMT-0600 (Central Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
